<view class="login-page">
  <!-- 顶部装饰背景 - 简笔画图案 -->
  <view class="header-bg">
    <view class="circle-1"></view>
    <view class="circle-2"></view>
    <view class="deco-line-1"></view>
    <view class="deco-line-2"></view>
    <view class="deco-dot-1"></view>
    <view class="deco-dot-2"></view>
    <view class="deco-dot-3"></view>
  </view>

  <!-- Logo和标题区域 -->
  <view class="logo-section">
    <view class="logo-icon">
      <image class="logo-img" src="/images/tab/login.png" mode="aspectFit"></image>
    </view>
    <text class="app-title">移动课堂</text>
    <text class="app-subtitle">智慧学习，随时随地</text>
  </view>

  <!-- 登录表单卡片 -->
  <view class="login-card">
    <!-- 账号输入 -->
    <view class="input-group">
      <view class="input-icon">👤</view>
      <input
        class="login-input"
        placeholder="请输入学号/账号"
        placeholder-class="placeholder"
        bindinput="onStudentNoInput"
        value="{{studentNo}}"
      />
    </view>

    <!-- 密码输入 -->
    <view class="input-group">
      <view class="input-icon">🔒</view>
      <input
        class="login-input"
        password
        placeholder="请输入密码"
        placeholder-class="placeholder"
        bindinput="onPasswordInput"
        value="{{password}}"
      />
    </view>

    <!-- 验证码区域 -->
    <view class="captcha-group">
      <view class="input-group captcha-input-wrapper">
        <view class="input-icon">🔢</view>
        <input
          class="login-input"
          placeholder="请输入验证码"
          placeholder-class="placeholder"
          bindinput="onCaptchaInput"
          value="{{captchaCode}}"
        />
      </view>
      <view class="captcha-img-wrapper" bindtap="refreshCaptcha">
        <image
          wx:if="{{captchaImg}}"
          src="{{captchaImg.indexOf('data:')===0 ? captchaImg : 'data:image/gif;base64,'+captchaImg}}"
          class="captcha-img"
          mode="aspectFit"
        />
        <view wx:else class="captcha-btn" bindtap="openWebCaptcha">
          <text>获取验证码</text>
        </view>
      </view>
    </view>
    <view class="captcha-tip">
      <text>点击图片可刷新验证码</text>
    </view>
    <view wx:if="{{captchaError}}" class="error-msg">{{captchaError}}</view>

    <!-- 登录按钮 -->
    <button class="login-btn" bindtap="onSubmit">
      <text>登 录</text>
    </button>

    <!-- 微信一键登录按钮 -->
    <button class="wx-login-btn" type="primary" bindtap="onWxLogin">
      <text>微信一键登录</text>
    </button>
  </view>

  <!-- 底部说明 -->
  <view class="footer-text">
    <text>首次登录请使用学号和初始密码</text>
  </view>

  <!-- 调试信息（仅在有返回时显示） -->
  <view wx:if="{{lastLoginResponse}}" class="debug-info">
    <text class="debug-title">调试信息：</text>
    <text class="debug-content">{{lastLoginResponse}}</text>
  </view>
</view>

